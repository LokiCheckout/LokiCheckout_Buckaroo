<?php
declare(strict_types=1);

use Loki\Components\Factory\ViewModelFactory;
use LokiCheckout\Buckaroo\Component\Creditcard\CreditcardViewModel;
use Magento\Framework\Escaper;
use Magento\Framework\View\Element\Template;
use Loki\CssUtils\Util\CssClass;

/** @version 2.0.9 */
/** @var Escaper $escaper */
/** @var Template $block */
/** @var CssClass $css */
/** @var CreditcardViewModel $viewModel */
/** @var ViewModelFactory $viewModelFactory */

$cards = $viewModel->getCards();
?>
<div class="<?= /* @noEscape */ $css('my-4') ?>">
    <span class="<?= /* @noEscape */ $css('', 'label') ?>">
        <?= $escaper->escapeHtml(__('Select a Credit Card or Debit Card:')) ?>
    </span>
    <div>
        <?php foreach ($cards as $card): ?>
            <div class="<?= /* @noEscape */ $css('flex gap-3 my-3', 'item') ?>">
                <div class="<?= /* @noEscape */ $css('w-8', 'item-image') ?>">
                    <img src="<?= $escaper->escapeUrl($card['img']) ?>""/>
                </div>
                <input
                    id="<?= $escaper->escapeHtml($viewModel->getElementId() . '-' . $card['code']) ?>"
                    class="<?= /* @noEscape */ $css('', 'item-input') ?>"
                    @change="selectCard"
                    <?php if ($viewModel->getValue() === $card['code']): ?>checked<?php endif; ?>
                    type="radio"
                    required
                    name="<?= $escaper->escapeHtml($card['code']) ?>"
                />
                <label
                    for="<?= $escaper->escapeHtml($viewModel->getElementId() . '-' . $card['code']) ?>"
                    class="<?= /* @noEscape */ $css('', 'item-label') ?>"
                >
                    <?= $escaper->escapeHtml($card['name']) ?>
                </label>
            </div>
        <?php endforeach; ?>
    </div>
</div>
